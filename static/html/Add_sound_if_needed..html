Add sound if needed.<br />
user<br />
#!/home/jack/miniconda3/envs/cloned_base/bin/python<br />
from moviepy.video.compositing.transitions import slide_in<br />
from moviepy.video.fx import all<br />
from moviepy.editor import *<br />
import glob<br />
import random<br />
from PIL import Image<br />
import cv2<br />
import os<br />
import uuid<br />
import shutil<br />
from sys import argv<br />
<br />
def add_title_image(video_path, hex_color = "#A52A2A"):<br />
    hex_color=random.choice(["#A52A2A","#ad1f1f","#16765c","#7a4111","#9b1050","#8e215d","#2656ca"])<br />
    # Define the directory path<br />
    directory_path = "temp"<br />
    # Check if the directory exists<br />
    if not os.path.exists(directory_path):<br />
        # If not, create it<br />
        os.makedirs(directory_path)<br />
        print(f"Directory '{directory_path}' created.")<br />
    else:<br />
        print(f"Directory '{directory_path}' already exists.") <br />
    # Load the video file and title image<br />
    video_clip = VideoFileClip(video_path)<br />
    print(video_clip.size)<br />
    width, height = video_clip.size<br />
    title_image_path = "/mnt/HDD500/EXPER/static/assets/Title_Image02.png"<br />
    # Set the desired size of the padded video (e.g., video width + padding, video height + padding)<br />
    padded_size = (width + 90, height + 90)<br />
<br />
    # Calculate the position for centering the video within the larger frame<br />
    x_position = (padded_size[0] - video_clip.size[0]) / 2<br />
    y_position = (padded_size[1] - video_clip.size[1]) / 2<br />
    #hex_color = "#09723c"<br />
    # Remove the '#' and split the hex code into R, G, and B components<br />
    r = int(hex_color[1:3], 16)<br />
    g = int(hex_color[3:5], 16)<br />
    b = int(hex_color[5:7], 16)<br />
<br />
    # Create an RGB tuple<br />
    rgb_tuple = (r, g, b)<br />
<br />
    # Create a blue ColorClip as the background<br />
    blue_background = ColorClip(padded_size, color=rgb_tuple)<br />
<br />
    # Add the video clip on top of the red background<br />
    padded_video_clip = CompositeVideoClip([blue_background, video_clip.set_position((x_position, y_position))])<br />
    padded_video_clip = padded_video_clip.set_duration(video_clip.duration)<br />
    #title_image_path = "/home/jack/Desktop/EXPER/static/assets/Title_Image02.png"<br />
    # Load the title image<br />
    title_image = ImageClip(title_image_path)<br />
<br />
    # Set the duration of the title image<br />
    title_duration = video_clip.duration<br />
    title_image = title_image.set_duration(title_duration)<br />
<br />
    print(video_clip.size)<br />
    # Position the title image at the center and resize it to fit the video dimensions<br />
    #title_image = title_image.set_position(("left", "top"))<br />
    title_image = title_image.set_position((0, -5))<br />
    #video_clip.size = (620,620)<br />
    title_image = title_image.resize(padded_video_clip.size)<br />
<br />
    # Position the title image at the center and resize it to fit the video dimensions<br />
    #title_image = title_image.set_position(("center", "center")).resize(video_clip.size)<br />
<br />
    # Create a composite video clip with the title image overlay<br />
    composite_clip = CompositeVideoClip([padded_video_clip, title_image])<br />
    # Limit the length to 58 seconds<br />
    composite_clip = composite_clip.subclip(0, 40)<br />
    # Load a random background music<br />
    mp3_files = glob.glob("/mnt/HDD500/collections/Music/*.mp3")<br />
    random.shuffle(mp3_files)<br />
<br />
    # Now choose a random MP3 file from the shuffled list<br />
    mp_music = random.choice(mp3_files)<br />
<br />
    # Load the background music without setting duration<br />
    music_clip = AudioFileClip(mp_music)<br />
    music_clip = music_clip.subclip(0, 40)<br />
    fade_duration = 1.0<br />
    music_clip = music_clip.audio_fadein(fade_duration).audio_fadeout(fade_duration)<br />
    # Set the audio of the composite clip to the background music<br />
    composite_clip = composite_clip.set_audio(music_clip)<br />
    output_path = 'temp/final_output3.mp4'<br />
    # Export the final video with the background music<br />
    composite_clip.write_videofile(output_path)<br />
    uid = str(uuid.uuid4())  # Generate a unique ID using uuid<br />
    mp4_file =  f"/home/jack/Desktop/HDD500/collections/vids/Ready_Post_{uid}.mp4"<br />
    shutil.copyfile(output_path, mp4_file)     <br />
    print(mp4_file)<br />
    VIDEO = output_path<br />
    return VIDEO<br />
if __name__=="__main__":<br />
    #video_path = "/mnt/HDD500/EXPER/static/assets/Title_Image02.png"<br />
    video_path = argv[1]<br />
    add_title_image(video_path, hex_color = "#A52A2A")    <br />
------------  I want this to only add sound "ONLY" if the video has no sound<br />
ChatGPT<br />
Certainly, Jack! Here's the modified script that only adds sound if the input video has no sound:<br />
<br />
```python<br />
#!/home/jack/miniconda3/envs/cloned_base/bin/python<br />
from moviepy.video.compositing.transitions import slide_in<br />
from moviepy.video.fx import all<br />
from moviepy.editor import *<br />
import glob<br />
import random<br />
from PIL import Image<br />
import cv2<br />
import os<br />
import uuid<br />
import shutil<br />
from sys import argv<br />
<br />
def add_title_image(video_path, hex_color="#A52A2A"):<br />
    # Define the directory path<br />
    directory_path = "temp"<br />
    # Check if the directory exists<br />
    if not os.path.exists(directory_path):<br />
        # If not, create it<br />
        os.makedirs(directory_path)<br />
        print(f"Directory '{directory_path}' created.")<br />
    else:<br />
        print(f"Directory '{directory_path}' already exists.")<br />
<br />
    # Load the video file and title image<br />
    video_clip = VideoFileClip(video_path)<br />
    print(video_clip.size)<br />
    width, height = video_clip.size<br />
    title_image_path = "/mnt/HDD500/EXPER/static/assets/Title_Image02.png"<br />
    # Set the desired size of the padded video (e.g., video width + padding, video height + padding)<br />
    padded_size = (width + 90, height + 90)<br />
<br />
    # Calculate the position for centering the video within the larger frame<br />
    x_position = (padded_size[0] - video_clip.size[0]) / 2<br />
    y_position = (padded_size[1] - video_clip.size[1]) / 2<br />
    # hex_color = "#09723c"<br />
    # Remove the '#' and split the hex code into R, G, and B components<br />
    r = int(hex_color[1:3], 16)<br />
    g = int(hex_color[3:5], 16)<br />
    b = int(hex_color[5:7], 16)<br />
<br />
    # Create an RGB tuple<br />
    rgb_tuple = (r, g, b)<br />
<br />
    # Create a blue ColorClip as the background<br />
    blue_background = ColorClip(padded_size, color=rgb_tuple)<br />
<br />
    # Add the video clip on top of the red background<br />
    padded_video_clip = CompositeVideoClip(<br />
        [blue_background, video_clip.set_position((x_position, y_position))])<br />
    padded_video_clip = padded_video_clip.set_duration(video_clip.duration)<br />
    # title_image_path = "/home/jack/Desktop/EXPER/static/assets/Title_Image02.png"<br />
    # Load the title image<br />
    title_image = ImageClip(title_image_path)<br />
<br />
    # Set the duration of the title image<br />
    title_duration = video_clip.duration<br />
    title_image = title_image.set_duration(title_duration)<br />
<br />
    print(video_clip.size)<br />
    # Position the title image at the center and resize it to fit the video dimensions<br />
    # title_image = title_image.set_position(("left", "top"))<br />
    title_image = title_image.set_position((0, -5))<br />
    # video_clip.size = (620,620)<br />
    title_image = title_image.resize(padded_video_clip.size)<br />
<br />
    # Position the title image at the center and resize it to fit the video dimensions<br />
    # title_image = title_image.set_position(("center", "center")).resize(video_clip.size)<br />
<br />
    # Create a composite video clip with the title image overlay<br />
    composite_clip = CompositeVideoClip([padded_video_clip, title_image])<br />
    # Limit the length to 58 seconds<br />
    composite_clip = composite_clip.subclip(0, 40)<br />
<br />
    # Check if the video has no audio<br />
    if not composite_clip.audio:<br />
        # Load a random background music<br />
        mp3_files = glob.glob("/mnt/HDD500/collections/Music/*.mp3")<br />
        random.shuffle(mp3_files)<br />
<br />
        # Now choose a random MP3 file from the shuffled list<br />
        mp_music = random.choice(mp3_files)<br />
<br />
        # Load the background music without setting duration<br />
        music_clip = AudioFileClip(mp_music)<br />
        music_clip = music_clip.subclip(0, 40)<br />
        fade_duration = 1.0<br />
        music_clip = music_clip.audio_fadein(fade_duration).audio_fadeout(fade_duration)<br />
        # Set the audio of the composite clip to the background music<br />
        composite_clip = composite_clip.set_audio(music_clip)<br />
<br />
    output_path = 'temp/final_output3.mp4'<br />
    # Export the final video with the background music<br />
    composite_clip.write_videofile(output_path)<br />
    uid = str(uuid.uuid4())  # Generate a unique ID using uuid<br />
    mp4_file = f"/home/jack/Desktop/HDD500/collections/vids/Ready_Post_{uid}.mp4"<br />
    shutil.copyfile(output_path, mp4_file)<br />
    print(mp4_file)<br />
    VIDEO = output_path<br />
    return VIDEO<br />
<br />
if __name__ == "__main__":<br />
    # video_path = "/mnt/HDD500/EXPER/static/assets/Title_Image02.png"<br />
    video_path = argv[1]<br />
    add_title_image(video_path, hex_color="#A52A2A")<br />
```<br />
<br />
This script will check if the input video has no audio, and if so, it will add background music. Otherwise, it will keep the existing audio. Let me know if you need any further adjustments or explanations!<br />
<br />
